<!doctype html>
<html class="no-js" lang="en" data-content_root="./">
  <head><meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <meta name="color-scheme" content="light dark"><meta name="viewport" content="width=device-width, initial-scale=1" />
<link rel="index" title="Index" href="genindex.html" /><link rel="search" title="Search" href="search.html" /><link rel="prev" title="Airpeak documentation" href="index.html" />

    <!-- Generated with Sphinx 8.2.3 and Furo 2025.07.19 -->
        <title>API Reference - Airpeak documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css?v=d111a655" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo.css?v=25af2a20" />
    <link rel="stylesheet" type="text/css" href="_static/styles/furo-extensions.css?v=8dab3a3b" />
    
    


<style>
  body {
    --color-code-background: #f2f2f2;
  --color-code-foreground: #1e1e1e;
  
  }
  @media not print {
    body[data-theme="dark"] {
      --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
    }
    @media (prefers-color-scheme: dark) {
      body:not([data-theme="light"]) {
        --color-code-background: #2b2b2b;
  --color-code-foreground: #f8f8f2;
  
      }
    }
  }
</style></head>
  <body>
    
    <script>
      document.body.dataset.theme = localStorage.getItem("theme") || "auto";
    </script>
    

<svg xmlns="http://www.w3.org/2000/svg" style="display: none;">
  <symbol id="svg-toc" viewBox="0 0 24 24">
    <title>Contents</title>
    <svg stroke="currentColor" fill="currentColor" stroke-width="0" viewBox="0 0 1024 1024">
      <path d="M408 442h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8zm-8 204c0 4.4 3.6 8 8 8h480c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8H408c-4.4 0-8 3.6-8 8v56zm504-486H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zm0 632H120c-4.4 0-8 3.6-8 8v56c0 4.4 3.6 8 8 8h784c4.4 0 8-3.6 8-8v-56c0-4.4-3.6-8-8-8zM115.4 518.9L271.7 642c5.8 4.6 14.4.5 14.4-6.9V388.9c0-7.4-8.5-11.5-14.4-6.9L115.4 505.1a8.74 8.74 0 0 0 0 13.8z"/>
    </svg>
  </symbol>
  <symbol id="svg-menu" viewBox="0 0 24 24">
    <title>Menu</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-menu">
      <line x1="3" y1="12" x2="21" y2="12"></line>
      <line x1="3" y1="6" x2="21" y2="6"></line>
      <line x1="3" y1="18" x2="21" y2="18"></line>
    </svg>
  </symbol>
  <symbol id="svg-arrow-right" viewBox="0 0 24 24">
    <title>Expand</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather-chevron-right">
      <polyline points="9 18 15 12 9 6"></polyline>
    </svg>
  </symbol>
  <symbol id="svg-sun" viewBox="0 0 24 24">
    <title>Light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="feather-sun">
      <circle cx="12" cy="12" r="5"></circle>
      <line x1="12" y1="1" x2="12" y2="3"></line>
      <line x1="12" y1="21" x2="12" y2="23"></line>
      <line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line>
      <line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line>
      <line x1="1" y1="12" x2="3" y2="12"></line>
      <line x1="21" y1="12" x2="23" y2="12"></line>
      <line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line>
      <line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line>
    </svg>
  </symbol>
  <symbol id="svg-moon" viewBox="0 0 24 24">
    <title>Dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-moon">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M12 3c.132 0 .263 0 .393 0a7.5 7.5 0 0 0 7.92 12.446a9 9 0 1 1 -8.313 -12.454z" />
    </svg>
  </symbol>
  <symbol id="svg-sun-with-moon" viewBox="0 0 24 24">
    <title>Auto light/dark, in light mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path style="opacity: 50%" d="M 5.411 14.504 C 5.471 14.504 5.532 14.504 5.591 14.504 C 3.639 16.319 4.383 19.569 6.931 20.352 C 7.693 20.586 8.512 20.551 9.25 20.252 C 8.023 23.207 4.056 23.725 2.11 21.184 C 0.166 18.642 1.702 14.949 4.874 14.536 C 5.051 14.512 5.231 14.5 5.411 14.5 L 5.411 14.504 Z"/>
      <line x1="14.5" y1="3.25" x2="14.5" y2="1.25"/>
      <line x1="14.5" y1="15.85" x2="14.5" y2="17.85"/>
      <line x1="10.044" y1="5.094" x2="8.63" y2="3.68"/>
      <line x1="19" y1="14.05" x2="20.414" y2="15.464"/>
      <line x1="8.2" y1="9.55" x2="6.2" y2="9.55"/>
      <line x1="20.8" y1="9.55" x2="22.8" y2="9.55"/>
      <line x1="10.044" y1="14.006" x2="8.63" y2="15.42"/>
      <line x1="19" y1="5.05" x2="20.414" y2="3.636"/>
      <circle cx="14.5" cy="9.55" r="3.6"/>
    </svg>
  </symbol>
  <symbol id="svg-moon-with-sun" viewBox="0 0 24 24">
    <title>Auto light/dark, in dark mode</title>
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round"
      class="icon-custom-derived-from-feather-sun-and-tabler-moon">
      <path d="M 8.282 7.007 C 8.385 7.007 8.494 7.007 8.595 7.007 C 5.18 10.184 6.481 15.869 10.942 17.24 C 12.275 17.648 13.706 17.589 15 17.066 C 12.851 22.236 5.91 23.143 2.505 18.696 C -0.897 14.249 1.791 7.786 7.342 7.063 C 7.652 7.021 7.965 7 8.282 7 L 8.282 7.007 Z"/>
      <line style="opacity: 50%" x1="18" y1="3.705" x2="18" y2="2.5"/>
      <line style="opacity: 50%" x1="18" y1="11.295" x2="18" y2="12.5"/>
      <line style="opacity: 50%" x1="15.316" y1="4.816" x2="14.464" y2="3.964"/>
      <line style="opacity: 50%" x1="20.711" y1="10.212" x2="21.563" y2="11.063"/>
      <line style="opacity: 50%" x1="14.205" y1="7.5" x2="13.001" y2="7.5"/>
      <line style="opacity: 50%" x1="21.795" y1="7.5" x2="23" y2="7.5"/>
      <line style="opacity: 50%" x1="15.316" y1="10.184" x2="14.464" y2="11.036"/>
      <line style="opacity: 50%" x1="20.711" y1="4.789" x2="21.563" y2="3.937"/>
      <circle style="opacity: 50%" cx="18" cy="7.5" r="2.169"/>
    </svg>
  </symbol>
  <symbol id="svg-pencil" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-pencil-code">
      <path d="M4 20h4l10.5 -10.5a2.828 2.828 0 1 0 -4 -4l-10.5 10.5v4" />
      <path d="M13.5 6.5l4 4" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
  <symbol id="svg-eye" viewBox="0 0 24 24">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="none" stroke="currentColor"
      stroke-width="1" stroke-linecap="round" stroke-linejoin="round" class="icon-tabler-eye-code">
      <path stroke="none" d="M0 0h24v24H0z" fill="none" />
      <path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" />
      <path
        d="M11.11 17.958c-3.209 -.307 -5.91 -2.293 -8.11 -5.958c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6c-.21 .352 -.427 .688 -.647 1.008" />
      <path d="M20 21l2 -2l-2 -2" />
      <path d="M17 17l-2 2l2 2" />
    </svg>
  </symbol>
</svg>

<input type="checkbox" class="sidebar-toggle" name="__navigation" id="__navigation">
<input type="checkbox" class="sidebar-toggle" name="__toc" id="__toc">
<label class="overlay sidebar-overlay" for="__navigation">
  <div class="visually-hidden">Hide navigation sidebar</div>
</label>
<label class="overlay toc-overlay" for="__toc">
  <div class="visually-hidden">Hide table of contents sidebar</div>
</label>

<a class="skip-to-content muted-link" href="#furo-main-content">Skip to content</a>



<div class="page">
  <header class="mobile-header">
    <div class="header-left">
      <label class="nav-overlay-icon" for="__navigation">
        <div class="visually-hidden">Toggle site navigation sidebar</div>
        <i class="icon"><svg><use href="#svg-menu"></use></svg></i>
      </label>
    </div>
    <div class="header-center">
      <a href="index.html"><div class="brand">Airpeak  documentation</div></a>
    </div>
    <div class="header-right">
      <div class="theme-toggle-container theme-toggle-header">
        <button class="theme-toggle">
          <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
          <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
          <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
          <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
          <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
        </button>
      </div>
      <label class="toc-overlay-icon toc-header-icon" for="__toc">
        <div class="visually-hidden">Toggle table of contents sidebar</div>
        <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
      </label>
    </div>
  </header>
  <aside class="sidebar-drawer">
    <div class="sidebar-container">
      
      <div class="sidebar-sticky"><a class="sidebar-brand" href="index.html">
  
  <span class="sidebar-brand-text">Airpeak  documentation</span>
  
</a><form class="sidebar-search-container" method="get" action="search.html" role="search">
  <input class="sidebar-search" placeholder="Search" name="q" aria-label="Search">
  <input type="hidden" name="check_keywords" value="yes">
  <input type="hidden" name="area" value="default">
</form>
<div id="searchbox"></div><div class="sidebar-scroll"><div class="sidebar-tree">
  <ul class="current">
<li class="toctree-l1 current current-page"><a class="current reference internal" href="#">API Reference</a></li>
</ul>

</div>
</div>

      </div>
      
    </div>
  </aside>
  <div class="main">
    <div class="content">
      <div class="article-container">
        <a href="#" class="back-to-top muted-link">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
            <path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8v12z"></path>
          </svg>
          <span>Back to top</span>
        </a>
        <div class="content-icon-container">
          <div class="view-this-page">
  <a class="muted-link" href="_sources/modules.rst.txt" title="View this page">
    <svg><use href="#svg-eye"></use></svg>
    <span class="visually-hidden">View this page</span>
  </a>
</div>
<div class="theme-toggle-container theme-toggle-content">
            <button class="theme-toggle">
              <div class="visually-hidden">Toggle Light / Dark / Auto color theme</div>
              <svg class="theme-icon-when-auto-light"><use href="#svg-sun-with-moon"></use></svg>
              <svg class="theme-icon-when-auto-dark"><use href="#svg-moon-with-sun"></use></svg>
              <svg class="theme-icon-when-dark"><use href="#svg-moon"></use></svg>
              <svg class="theme-icon-when-light"><use href="#svg-sun"></use></svg>
            </button>
          </div>
          <label class="toc-overlay-icon toc-content-icon" for="__toc">
            <div class="visually-hidden">Toggle table of contents sidebar</div>
            <i class="icon"><svg><use href="#svg-toc"></use></svg></i>
          </label>
        </div>
        <article role="main" id="furo-main-content">
          <section id="module-Airpeak">
<span id="api-reference"></span><h1>API Reference<a class="headerlink" href="#module-Airpeak" title="Link to this heading">¶</a></h1>
<dl class="py function">
<dt class="sig sig-object py" id="Airpeak.baseline_detection">
<span class="sig-prename descclassname"><span class="pre">Airpeak.</span></span><span class="sig-name descname"><span class="pre">baseline_detection</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollutant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_lambda</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000000.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">base_p</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.001</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Airpeak.baseline_detection" title="Link to this definition">¶</a></dt>
<dd><p>Detects baseline from pollutant concentration data using Asymmetric Least Squares smoothing.</p>
<p>This function processes a DataFrame containing pollutant measurements and calculates
the baseline signal using the baseline_als algorithm. It adds padding to the beginning
and end of the data to improve edge detection. Knowing the baseline (e.g., outdoor concentration)
is essential for estimating pollutant loss rate using on mass balance models.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing pollutant measurements</p></li>
<li><p><strong>pollutant</strong> (<em>str</em>) – Column name in the DataFrame containing the pollutant measurements</p></li>
<li><p><strong>base_lambda</strong> (<em>float</em><em>, </em><em>optional</em>) – Smoothing parameter for baseline_als algorithm (default is 1×10⁶)</p></li>
<li><p><strong>base_p</strong> (<em>float</em><em>, </em><em>optional</em>) – Asymmetry parameter for baseline_als algorithm (default is 0.001)</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A copy of the input DataFrame with an additional ‘baseline’ column containing
the calculated baseline values</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function adds padding (100000 points) at the beginning and end of the data
to improve baseline detection at the edges. These padding points are removed
from the final output.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Airpeak.dbscan">
<span class="sig-prename descclassname"><span class="pre">Airpeak.</span></span><span class="sig-name descname"><span class="pre">dbscan</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ms</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">RobustScaler()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Airpeak.dbscan" title="Link to this definition">¶</a></dt>
<dd><p>Apply DBSCAN clustering algorithm to time series data grouped by date.
This function processes time series data by applying DBSCAN clustering to identify groups
of individual decay events in data labeled as “decay” by the k_means_diff function.
The data is first split by date to make hyperparameter selection more universal.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing time series data with status labels</p></li>
<li><p><strong>timestamp</strong> (<em>str</em>) – Name of the timestamp column in the DataFrame</p></li>
<li><p><strong>eps</strong> (<em>float</em><em>, </em><em>optional</em><em> (</em><em>default=0.01</em><em>)</em>) – The maximum distance between two samples for one to be considered as in the neighborhood of the other.
This is the most important DBSCAN parameter to choose appropriately for your data set and distance function.</p></li>
<li><p><strong>ms</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default=2</em><em>)</em>) – The number of samples in a neighborhood for a point to be considered as a core point.</p></li>
<li><p><strong>transformer</strong> (<em>sklearn.preprocessing object</em><em>, </em><em>optional</em><em> (</em><em>default=RobustScaler</em><em>(</em><em>)</em><em>)</em>) – Scaler to use for data preprocessing before DBSCAN clustering</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A DataFrame containing the original data with an additional ‘decay_group’ column where:
- -1 represents noise points or non-decay events
- Other integers represent different decay event clusters</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function:
1. Splits data by date
2. Creates a cumulative sum of non-decay events
3. Applies DBSCAN clustering on decay events (status_label=1)
4. Merges results back with original data
Any errors in processing a specific date are silently ignored (the function continues
with the next date).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Airpeak.decay_regress">
<span class="sig-prename descclassname"><span class="pre">Airpeak.</span></span><span class="sig-name descname"><span class="pre">decay_regress</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df_date</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollutant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">portion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">[0,</span> <span class="pre">1]</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Airpeak.decay_regress" title="Link to this definition">¶</a></dt>
<dd><p>Performs linear regression analysis on individual decay periods in time series data.</p>
<p>This function analyzes identified individual decay periods in pollutant concentration data,
calculating decay rates and associated statistics through linear regression of
log-transformed concentrations. The analysis is based on mass balance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df_date</strong> (<em>pandas.DataFrame</em>) – DataFrame containing the time series data with decay periods identified</p></li>
<li><p><strong>pollutant</strong> (<em>str</em>) – Name of the column containing pollutant concentrations</p></li>
<li><p><strong>timestamp</strong> (<em>str</em>) – Name of the column containing timestamp data</p></li>
<li><p><strong>portion</strong> (<em>list</em><em> of </em><em>float</em><em>, </em><em>optional</em>) – Two elements list specifying the start and end portions of each decay period to use
[start_fraction, end_fraction], default [0,1] uses entire periods</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame containing regression results with columns:
- pollutant: name of analyzed pollutant
- time: midpoint timestamp of decay period
- decay_start: start time of decay period
- decay_end: end time of decay period
- decay_rate: calculated decay rate coefficient
- r2: R-squared value of regression
- ste: standard error of regression
- num_of_point: number of points in regression
- base_value: baseline concentration at start
- median_ele: median concentration above baseline of decay period
- max_diff: maximum concentration difference of decay period
- group: decay period identifier
- method: analysis method identifier (‘decay’)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<ul class="simple">
<li><p>Requires decay periods to be pre-identified in ‘decay_group’ column</p></li>
<li><p>Performs log-linear regression on concentration differences from baseline</p></li>
<li><p>Excludes decay periods with fewer than 3 points</p></li>
<li><p>Uses natural logarithm for decay rate calculation</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Airpeak.feature_generation">
<span class="sig-prename descclassname"><span class="pre">Airpeak.</span></span><span class="sig-name descname"><span class="pre">feature_generation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollutant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_ma_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">diff_rhl_window</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Airpeak.feature_generation" title="Link to this definition">¶</a></dt>
<dd><p>Generate additional features from time series data of pollutant measurements.
This function calculates several features based on the difference between pollutant
measurements and their baseline values, including moving averages, gradients,
and relative high-low metrics.
:type df: 
:param df: Input DataFrame containing pollutant measurements and baseline values
:type df: pandas.DataFrame
:type pollutant: 
:param pollutant: Column name for the pollutant measurements
:type pollutant: str
:type timestamp: 
:param timestamp: Column name for the timestamp data
:type timestamp: str
:type diff_ma_window: 
:param diff_ma_window: Window size for moving average calculation (default is 5)
:type diff_ma_window: int, optional
:type diff_rhl_window: 
:param diff_rhl_window: Window size for relative high-low calculation (default is 5)
:type diff_rhl_window: int, optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>DataFrame with original data and additional features:
- min_diff: time difference between adjacent measurements in minutes
- diff: difference between pollutant and baseline concentrations
- diff_ma: moving average of the concentration difference
- diff_gd: gradient of concentration difference
- diff_gd_ln: natural log of concentration difference gradient
- diff_gd_sign: binary indicator of positive/negative gradient
- diff_gd_abs: absolute value of the gradient
- diff_rhl: relative high-low metric (see Ref section)</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function assumes input DataFrame contains ‘baseline’ column.
Natural log transformation of negative values results in NaN, which are filled with 0.
Ref
—–
Anghinoni, L.; Zhao, L.; Ji, D.; Pan, H. Time series trend detection and forecasting
using complex network topology analysis. Neural Networks 2019, 117, 295– 306,
DOI: 10.1016/J.NEUNET.2019.05.018</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Airpeak.k_means_diff">
<span class="sig-prename descclassname"><span class="pre">Airpeak.</span></span><span class="sig-name descname"><span class="pre">k_means_diff</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">timestamp</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_clusters</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">MinMaxScaler()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">QuantileTransformer()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Airpeak.k_means_diff" title="Link to this definition">¶</a></dt>
<dd><p>Performs K-means clustering on concentration gradient data to classify different states in time series.</p>
<p>This function applies K-means clustering to identify different states (build-up, decay,
and optionally plateau) in the data labeled as elevated from the previous step.
It processes elevated periods in the data only and labels them according to their gradient characteristics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing concentration gradient data</p></li>
<li><p><strong>timestamp</strong> (<em>str</em>) – Column name for timestamp values</p></li>
<li><p><strong>n_clusters</strong> (<em>int</em><em>, </em><em>optional</em><em> (</em><em>default=2</em><em>)</em>) – Number of clusters for K-means (2 for build-up and decay states, 3 for with plateau state)</p></li>
<li><p><strong>scaler</strong> (<em>sklearn.preprocessing object</em><em>, </em><em>optional</em><em> (</em><em>default=MinMaxScaler</em><em>(</em><em>)</em><em>)</em>) – Scaler object for data normalization</p></li>
<li><p><strong>transformer</strong> (<em>sklearn.preprocessing object</em><em>, </em><em>optional</em><em> (</em><em>default=QuantileTransformer</em><em>(</em><em>)</em><em>)</em>) – Transformer object for data transformation</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>DataFrame with added ‘status_label’ column indicating state classification:
- 0: baseline (non-elevated periods, copied from k_means_ele)
- 1: decay
- 2: buildup (for n_clusters=2)
- 2: plateau, 3: buildup (for n_clusters=3)</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The function expects the input DataFrame to have ‘elevated’, ‘diff_gd_ln’, ‘diff_gd_abs’, and ‘diff_gd_sign’
columns. The ‘elevated’ column should be binary (0/1) indicating elevated periods.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Airpeak.k_means_ele">
<span class="sig-prename descclassname"><span class="pre">Airpeak.</span></span><span class="sig-name descname"><span class="pre">k_means_ele</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">scaler</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">MinMaxScaler()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">transformer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">QuantileTransformer()</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Airpeak.k_means_ele" title="Link to this definition">¶</a></dt>
<dd><p>Performs K-means clustering on concentration data to identify significant concentration elevations.</p>
<p>This function applies K-means clustering algorithm with 2 clusters on the provided dataframe
using ‘diff_ma’ (moving average difference) and ‘diff_gd_abs’ (absolute gradient difference)
features. The data is normalized using both scaling and quantile transformation before clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input dataframe containing columns ‘diff_ma’, ‘diff_gd_abs’, and ‘diff’</p></li>
<li><p><strong>scaler</strong> (<em>sklearn.preprocessing object</em><em>, </em><em>optional</em>) – Scaler for data normalization (default is MinMaxScaler())</p></li>
<li><p><strong>transformer</strong> (<em>sklearn.preprocessing object</em><em>, </em><em>optional</em>) – Transformer for data distribution (default is QuantileTransformer())</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A copy of input dataframe with an additional boolean column ‘elevated’ indicating
cluster membership. True (1) indicates elevated measurements, False (0) indicates
normal measurements. Elevated measurements will be further differentiated into
build-up, plateau, and decay events.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>The cluster with the higher average concentration value is automatically labeled as
the ‘elevated’ cluster (1), while the other cluster is labeled as normal (0).</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Airpeak.outlier_removal">
<span class="sig-prename descclassname"><span class="pre">Airpeak.</span></span><span class="sig-name descname"><span class="pre">outlier_removal</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollutant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">outlier_neighbors</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Airpeak.outlier_removal" title="Link to this definition">¶</a></dt>
<dd><p>Remove outliers from a DataFrame using Local Outlier Factor (LOF) algorithm.</p>
<p>This function applies the LOF algorithm to identify and remove outliers in a specified
pollutant column, considering the temporal sequence of measurements through the index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing the pollutant measurements</p></li>
<li><p><strong>pollutant</strong> (<em>str</em>) – Name of the column containing the pollutant data to check for outliers</p></li>
<li><p><strong>outlier_neighbors</strong> (<em>int</em>) – Number of neighbors to consider when determining if a point is an outlier</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new DataFrame with outliers removed, maintaining the same structure as the input
DataFrame but excluding the identified outlier rows</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This is an optional step. Consider apply it if the raw data contains obvious outliers.
The function uses both the temporal index and pollutant values to identify outliers.
Points identified as outliers (labeled as -1 by LOF) are removed from the dataset.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="Airpeak.smoothing">
<span class="sig-prename descclassname"><span class="pre">Airpeak.</span></span><span class="sig-name descname"><span class="pre">smoothing</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pollutant</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_window</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">smoothing_order</span></span></em><span class="sig-paren">)</span><a class="headerlink" href="#Airpeak.smoothing" title="Link to this definition">¶</a></dt>
<dd><p>Apply Savitzky-Golay filter to smooth pollutant data in a DataFrame.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em>) – Input DataFrame containing pollutant measurements</p></li>
<li><p><strong>pollutant</strong> (<em>str</em>) – Name of the column containing pollutant data to be smoothed</p></li>
<li><p><strong>smoothing_window</strong> (<em>int</em>) – Length of the filter window (must be odd number and greater than smoothing_order)</p></li>
<li><p><strong>smoothing_order</strong> (<em>int</em>) – Order of the polynomial used to fit the samples</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>A new DataFrame with smoothed pollutant data</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This step is optional. Consider applying it if the raw data is noisy.
Uses scipy.signal.savgol_filter for smoothing, which fits a polynomial of order
‘smoothing_order’ to windows of size ‘smoothing_window’.</p>
<p class="rubric">Example</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">smoothed_df</span> <span class="o">=</span> <span class="n">smoothing</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="s2">&quot;CO2&quot;</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>

        </article>
      </div>
      <footer>
        
        <div class="related-pages">
          
          <a class="prev-page" href="index.html">
              <svg class="furo-related-icon"><use href="#svg-arrow-right"></use></svg>
              <div class="page-info">
                <div class="context">
                  <span>Previous</span>
                </div>
                
                <div class="title">Home</div>
                
              </div>
            </a>
        </div>
        <div class="bottom-of-page">
          <div class="left-details">
            <div class="copyright">
                Copyright &#169; 2025, Bowen Du
            </div>
            Made with <a href="https://www.sphinx-doc.org/">Sphinx</a> and <a class="muted-link" href="https://pradyunsg.me">@pradyunsg</a>'s
            
            <a href="https://github.com/pradyunsg/furo">Furo</a>
            
          </div>
          <div class="right-details">
            
          </div>
        </div>
        
      </footer>
    </div>
    <aside class="toc-drawer">
      
      
      <div class="toc-sticky toc-scroll">
        <div class="toc-title-container">
          <span class="toc-title">
            On this page
          </span>
        </div>
        <div class="toc-tree-container">
          <div class="toc-tree">
            <ul>
<li><a class="reference internal" href="#">API Reference</a><ul>
<li><a class="reference internal" href="#Airpeak.baseline_detection"><code class="docutils literal notranslate"><span class="pre">baseline_detection()</span></code></a></li>
<li><a class="reference internal" href="#Airpeak.dbscan"><code class="docutils literal notranslate"><span class="pre">dbscan()</span></code></a></li>
<li><a class="reference internal" href="#Airpeak.decay_regress"><code class="docutils literal notranslate"><span class="pre">decay_regress()</span></code></a></li>
<li><a class="reference internal" href="#Airpeak.feature_generation"><code class="docutils literal notranslate"><span class="pre">feature_generation()</span></code></a></li>
<li><a class="reference internal" href="#Airpeak.k_means_diff"><code class="docutils literal notranslate"><span class="pre">k_means_diff()</span></code></a></li>
<li><a class="reference internal" href="#Airpeak.k_means_ele"><code class="docutils literal notranslate"><span class="pre">k_means_ele()</span></code></a></li>
<li><a class="reference internal" href="#Airpeak.outlier_removal"><code class="docutils literal notranslate"><span class="pre">outlier_removal()</span></code></a></li>
<li><a class="reference internal" href="#Airpeak.smoothing"><code class="docutils literal notranslate"><span class="pre">smoothing()</span></code></a></li>
</ul>
</li>
</ul>

          </div>
        </div>
      </div>
      
      
    </aside>
  </div>
</div><script src="_static/documentation_options.js?v=5929fcd5"></script>
    <script src="_static/doctools.js?v=9bcbadda"></script>
    <script src="_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="_static/scripts/furo.js?v=46bd48cc"></script>
    </body>
</html>